# ğŸ¬ WebAVæ’­æ”¾å™¨

ç°ä»£åŒ–çš„WebéŸ³è§†é¢‘æ’­æ”¾å™¨ï¼Œæ”¯æŒWebGPUã€WebGLã€AudioWorkletå’ŒWebCodecsç­‰å…ˆè¿›æŠ€æœ¯ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

```bash
# ä¸€é”®å¯åŠ¨
./start-webpack.sh

# æˆ–æ‰‹åŠ¨å¯åŠ¨
npm install
npm run dev
```

ç„¶åè®¿é—®: http://localhost:9000

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ¬ è§†é¢‘æ’­æ”¾
- æ”¯æŒMP4 (H.264, H.265), WebMç­‰æ ¼å¼
- WebGPU/WebGLç¡¬ä»¶åŠ é€Ÿæ¸²æŸ“
- OffscreenCanvasæ€§èƒ½ä¼˜åŒ–
- è‡ªé€‚åº”ç”»è´¨å’Œåˆ†è¾¨ç‡

### ğŸ”Š éŸ³é¢‘å¤„ç†
- AudioWorkleté«˜è´¨é‡éŸ³é¢‘å¤„ç†
- å¤šå£°é“éŸ³é¢‘æ”¯æŒ (ç«‹ä½“å£°/5.1/7.1)
- è™šæ‹Ÿç¯ç»•å£°æ•ˆæœ
- å®æ—¶éŸ³é‡æ§åˆ¶

### ğŸš€ é«˜çº§åŠŸèƒ½
- è¾¹ä¸‹è½½è¾¹æ’­æ”¾ (æµå¼æ’­æ”¾)
- å¿«é€Ÿå¯åŠ¨ä¼˜åŒ–
- WebCodecsç¡¬ä»¶è§£ç 
- FFmpeg.wasmè½¯ä»¶è§£ç åå¤‡
- SharedArrayBufferæ•°æ®ä¼˜åŒ–

### ğŸ›ï¸ æ’­æ”¾æ§åˆ¶
- æ’­æ”¾/æš‚åœ/åœæ­¢
- è¿›åº¦æ¡æ‹–æ‹½å®šä½
- å€é€Ÿæ’­æ”¾ (0.25x - 4x)
- éŸ³é‡æ§åˆ¶å’Œé™éŸ³
- å…¨å±æ’­æ”¾æ”¯æŒ

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **æ„å»ºå·¥å…·**: Webpack 5 + Babel
- **æ¸²æŸ“**: WebGPU â†’ WebGL â†’ Canvas 2D
- **éŸ³é¢‘**: AudioWorklet â†’ Web Audio API
- **è§£ç **: WebCodecs â†’ FFmpeg.wasm
- **æ•°æ®**: SharedArrayBuffer â†’ ArrayBuffer
- **è§£æ**: MP4Box.js + è‡ªå®šä¹‰æµè§£æå™¨

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- Node.js 16.0.0+
- npm 8.0.0+
- ç°ä»£æµè§ˆå™¨ (Chrome 90+, Firefox 88+, Safari 14+, Edge 90+)

## ğŸ“¦ npm è„šæœ¬

```bash
npm run dev         # å¼€å‘æœåŠ¡å™¨
npm run build       # ç”Ÿäº§æ„å»º
npm run build:dev   # å¼€å‘æ„å»º
npm run start       # å¼€å‘æœåŠ¡å™¨(è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨)
npm run clean       # æ¸…ç†æ„å»ºç›®å½•
npm run clean:all   # æ¸…ç†æ‰€æœ‰æ–‡ä»¶
npm run reinstall   # é‡æ–°å®‰è£…ä¾èµ–
npm run serve       # æ„å»ºå¹¶é¢„è§ˆ
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
webav-player/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.js              # åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ player.js            # ä¸»æ’­æ”¾å™¨ç±»
â”‚   â”œâ”€â”€ audio/               # éŸ³é¢‘å¤„ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ audio-player.js
â”‚   â”‚   â””â”€â”€ audio-worklet-processor.js
â”‚   â”œâ”€â”€ decoder/             # è§£ç å™¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ webcodecs-decoder.js
â”‚   â”‚   â””â”€â”€ ffmpeg-decoder.js
â”‚   â”œâ”€â”€ render/              # æ¸²æŸ“å™¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ webgpu-renderer.js
â”‚   â”‚   â””â”€â”€ webgl-renderer.js
â”‚   â”œâ”€â”€ parser/              # è§£æå™¨æ¨¡å—
â”‚   â”‚   â””â”€â”€ mp4-parser.js
â”‚   â””â”€â”€ utils/               # å·¥å…·ç±»
â”‚       â”œâ”€â”€ shared-buffer.js
â”‚       â””â”€â”€ stream-loader.js
â”œâ”€â”€ dist/                    # æ„å»ºè¾“å‡º
â”œâ”€â”€ webpack.config.js        # Webpacké…ç½®
â”œâ”€â”€ .babelrc                # Babelé…ç½®
â”œâ”€â”€ package.json            # é¡¹ç›®é…ç½®
â””â”€â”€ index.html              # HTMLæ¨¡æ¿
```

## ğŸ”§ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½
1. åœ¨ `src/` ç›®å½•ä¸‹åˆ›å»ºæ¨¡å—
2. åœ¨ `main.js` ä¸­å¯¼å…¥
3. Webpackè‡ªåŠ¨å¤„ç†ä¾èµ–

### è°ƒè¯•
- å¼€å‘ç¯å¢ƒè‡ªåŠ¨ç”ŸæˆSource Maps
- ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·è°ƒè¯•
- çƒ­é‡è½½æ”¯æŒä»£ç å®æ—¶æ›´æ–°

### éƒ¨ç½²
```bash
npm run build
# å°† dist/ ç›®å½•éƒ¨ç½²åˆ°WebæœåŠ¡å™¨
```

## ğŸ› å¸¸è§é—®é¢˜

**Q: å¯åŠ¨å¤±è´¥ï¼Ÿ**
```bash
npm run clean:all
npm install
```

**Q: ç«¯å£å†²çªï¼Ÿ**
- ä¿®æ”¹ `webpack.config.js` ä¸­çš„ `port: 9000`

**Q: æ„å»ºé”™è¯¯ï¼Ÿ**
- ç¡®ä¿Node.jsç‰ˆæœ¬ >= 16.0.0
- æ£€æŸ¥npmç‰ˆæœ¬ >= 8.0.0

## ğŸ¯ æµè§ˆå™¨æ”¯æŒ

| åŠŸèƒ½ | Chrome | Firefox | Safari | Edge |
|------|--------|---------|--------|------|
| WebCodecs | âœ… 94+ | ğŸ”„ å¼€å‘ä¸­ | âŒ | âœ… 94+ |
| WebGPU | âœ… 113+ | ğŸ”„ å¼€å‘ä¸­ | ğŸ”„ å¼€å‘ä¸­ | âœ… 113+ |
| AudioWorklet | âœ… 66+ | âœ… 76+ | âœ… 14.1+ | âœ… 79+ |
| SharedArrayBuffer | âœ… 68+ | âœ… 79+ | âœ… 15.2+ | âœ… 79+ |

## ğŸ“„ è®¸å¯è¯

MIT License

---

**ğŸ¬ ç«‹å³å¼€å§‹**: è¿è¡Œ `./start-webpack.sh`