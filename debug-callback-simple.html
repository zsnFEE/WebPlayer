<!DOCTYPE html>
<html>
<head>
    <title>å›è°ƒç®€å•æµ‹è¯•</title>
    <style>
        body { font-family: monospace; background: #000; color: #0f0; padding: 20px; }
        pre { background: #111; padding: 10px; border: 1px solid #333; }
    </style>
</head>
<body>
    <h1>ç®€å•å›è°ƒæµ‹è¯•</h1>
    <pre id="log"></pre>
    
    <script type="module">
        const log = document.getElementById('log');
        function print(msg) {
            log.textContent += new Date().toTimeString() + ': ' + msg + '\n';
            console.log(msg);
        }
        
        print('å¼€å§‹æµ‹è¯•...');
        
        try {
            // ç›´æ¥å¯¼å…¥MP4Parser
            const { MP4Parser } = await import('./src/parser/mp4-parser.js');
            print('MP4Parserå¯¼å…¥æˆåŠŸ');
            
            // åˆ›å»ºå®ä¾‹
            const parser = new MP4Parser();
            print('MP4Parserå®ä¾‹åˆ›å»ºæˆåŠŸ');
            
            // æ£€æŸ¥åˆå§‹çŠ¶æ€
            print('åˆå§‹onReady: ' + typeof parser.onReady);
            print('åˆå§‹onSamples: ' + typeof parser.onSamples);
            print('åˆå§‹onError: ' + typeof parser.onError);
            
            // è®¾ç½®å›è°ƒ
            parser.onReady = function(info) {
                print('ğŸ‰ onReadyè¢«è°ƒç”¨äº†ï¼info: ' + JSON.stringify(info));
            };
            
            parser.onError = function(error) {
                print('âŒ onErrorè¢«è°ƒç”¨: ' + error);
            };
            
            // éªŒè¯è®¾ç½®
            print('è®¾ç½®åonReady: ' + typeof parser.onReady);
            print('è®¾ç½®åonError: ' + typeof parser.onError);
            
            // åˆå§‹åŒ–
            print('å¼€å§‹åˆå§‹åŒ–...');
            parser.init();
            print('åˆå§‹åŒ–å®Œæˆ');
            
            // å†æ¬¡æ£€æŸ¥
            print('åˆå§‹åŒ–åonReady: ' + typeof parser.onReady);
            print('åˆå§‹åŒ–åonError: ' + typeof parser.onError);
            
            print('æµ‹è¯•å®Œæˆ - ç­‰å¾…æ‰‹åŠ¨æ–‡ä»¶æµ‹è¯•');
            
        } catch (error) {
            print('é”™è¯¯: ' + error.message);
            console.error(error);
        }
    </script>
</body>
</html>